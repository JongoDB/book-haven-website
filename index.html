<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Haven Bookstore</title>
    <style>
        :root {
            --primary-color: #8B2635;
            --secondary-color: #D4AF37;
            --bg-color: #FDF6E3;
            --text-dark: #131C26;
            --text-light: #131C26;
            --white: #ffffff;
            --success-color: #22C55E;
            --shadow: 0 4px 6px rgba(19, 28, 38, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Calibri', 'Arial', sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background-color: var(--bg-color);
        }

        header {
            background-color: var(--primary-color);
            color: var(--white);
            padding: 1rem 0;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo {
            width: 60px;
            height: 60px;
            background-color: var(--white);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 8px;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .site-title {
            font-family: 'Trebuchet MS', 'Arial', sans-serif;
            font-size: 1.8rem;
            font-weight: bold;
            margin: 0;
        }

        .site-subtitle {
            font-family: 'Comic Sans MS', 'Arial', sans-serif;
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 0.2rem;
        }

        nav ul {
            list-style: none;
            display: flex;
            gap: 1.5rem;
            flex-wrap: wrap;
        }

        nav a {
            color: var(--white);
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: background-color 0.3s;
            font-family: 'Calibri', 'Arial', sans-serif;
            font-weight: normal;
        }

        nav a:hover, nav a.active {
            background-color: rgba(255, 255, 255, 0.2);
        }

        main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            min-height: calc(100vh - 200px);
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .hero {
            text-align: center;
            padding: 3rem 0;
            background: linear-gradient(135deg, var(--bg-color), #f5e6d3);
            border-radius: 12px;
            margin-bottom: 2rem;
        }

        .hero h1 {
            font-family: 'Trebuchet MS', 'Arial', sans-serif;
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-weight: bold;
        }

        .hero p {
            font-family: 'Calibri', 'Arial', sans-serif;
            font-size: 1.2rem;
            color: var(--text-dark);
            max-width: 600px;
            margin: 0 auto;
        }

        .cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .card {
            background: var(--white);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: var(--shadow);
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .card-icon {
            font-size: 3rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .card h3 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-family: 'Impact', 'Arial Black', sans-serif;
            font-weight: bold;
        }

        .card p {
            font-family: 'Calibri', 'Arial', sans-serif;
            color: var(--text-dark);
        }

        .filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .filter-btn {
            background: var(--white);
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
            padding: 0.5rem 1rem;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }

        .filter-btn:hover, .filter-btn.active {
            background: var(--primary-color);
            color: var(--white);
        }

        .products {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .product-card {
            background: var(--white);
            border-radius: 12px;
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: transform 0.3s;
        }

        .product-card:hover {
            transform: translateY(-3px);
        }

        .product-image {
            width: 100%;
            height: 200px;
            background: linear-gradient(45deg, var(--primary-color), #A63446);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 2rem;
            font-weight: bold;
        }

        .product-info {
            padding: 1rem;
        }

        .product-title {
            font-family: 'Arial', sans-serif;
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: var(--primary-color);
        }

        .product-price {
            color: var(--secondary-color);
            font-weight: bold;
            font-size: 1.1rem;
        }

        .form-container {
            background: var(--white);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: var(--shadow);
            margin: 2rem 0;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .form-group textarea {
            height: 100px;
            resize: vertical;
        }

        .btn {
            background: var(--primary-color);
            color: var(--white);
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
            font-weight: 500;
        }

        .btn:hover {
            background: #7A1E2C;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--text-light);
        }

        .btn-secondary:hover {
            background: #555;
        }

        .btn-success {
            background: var(--success-color);
        }

        .info-table {
            width: 100%;
            background: var(--white);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
            margin: 2rem 0;
        }

        .info-table th,
        .info-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .info-table th {
            background: var(--primary-color);
            color: var(--white);
            font-weight: bold;
        }

        footer {
            background: var(--primary-color);
            color: var(--white);
            padding: 2rem 0 1rem;
            margin-top: 3rem;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            text-align: center;
        }

        .footer-subscribe {
            margin-bottom: 2rem;
        }

        .footer-subscribe h3 {
            margin-bottom: 1rem;
            font-family: 'Arial', sans-serif;
        }

        .subscribe-form {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .subscribe-form input {
            padding: 0.75rem;
            border: none;
            border-radius: 6px;
            min-width: 250px;
            font-size: 1rem;
        }

        .footer-nav {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }

        .footer-nav a {
            color: var(--white);
            text-decoration: none;
            opacity: 0.8;
            transition: opacity 0.3s;
        }

        .footer-nav a:hover {
            opacity: 1;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.3s;
        }

        .modal-content {
            background-color: var(--white);
            margin: 5% auto;
            padding: 2rem;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .close {
            color: var(--text-light);
            float: right;
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
        }

        .close:hover {
            color: var(--primary-color);
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid #eee;
        }

        .cart-empty {
            text-align: center;
            color: var(--text-light);
            padding: 2rem;
            font-style: italic;
        }

        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                text-align: center;
            }

            .hero h1 {
                font-size: 2rem;
            }

            main {
                padding: 1rem;
            }

            .cards {
                grid-template-columns: 1fr;
            }

            .products {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            }

            .subscribe-form {
                flex-direction: column;
                align-items: center;
            }

            .subscribe-form input {
                min-width: 200px;
            }

            nav ul {
                justify-content: center;
            }
        }

        @keyframes bounce {
            0%, 20%, 60%, 100% { transform: translateY(0); }
            40% { transform: translateY(-20px); }
            80% { transform: translateY(-10px); }
        }

        .success-message {
            background: var(--success-color);
            color: var(--white);
            padding: 1rem;
            border-radius: 6px;
            margin: 1rem 0;
            text-align: center;
            animation: bounce 1s ease-in-out;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        button:focus,
        input:focus,
        textarea:focus,
        a:focus {
            outline: 2px solid var(--secondary-color);
            outline-offset: 2px;
        }

        @media (prefers-contrast: high) {
            :root {
                --primary-color: #000000;
                --text-light: #000000;
                --shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            }
        }
    </style>
</head>
<body>
    <!-- Header with Navigation -->
    <header>
        <div class="header-container">
            <div class="logo-section">
                <div class="logo">
                    <img src="images/Client3_LogoPalette2_742C36.png" alt="Book Haven Logo" style="width: 100%; height: 100%; object-fit: contain;">
                </div>
                <div>
                    <h1 class="site-title">Book Haven Bookstore</h1>
                    <p class="site-subtitle">Literary Excellence Since Always</p>
                </div>
            </div>
            <div style="display: flex; align-items: center; gap: 2rem;">
                <button onclick="window.open('https://www.youtube.com/watch?v=xvFZjo5PgG0', '_blank')" 
                        style="background: var(--white); color: var(--primary-color); border: 2px solid var(--primary-color); padding: 0.5rem 1rem; border-radius: 6px; font-family: 'Calibri', 'Arial', sans-serif; font-weight: bold; cursor: pointer; transition: all 0.3s; font-size: 0.9rem;"
                        onmouseover="this.style.background='var(--primary-color)'; this.style.color='var(--white)'"
                        onmouseout="this.style.background='var(--white)'; this.style.color='var(--primary-color)'">
                    Sophia Easter Egg
                </button>
                <nav>
            <nav>
                <ul>
                    <li><a href="#home" class="nav-link active" onclick="showPage('home')">Home</a></li>
                    <li><a href="#gallery" class="nav-link" onclick="showPage('gallery')">Gallery</a></li>
                    <li><a href="#about" class="nav-link" onclick="showPage('about')">About Us</a></li>
                    <li><a href="#community" class="nav-link" onclick="showPage('community')">Community Corner</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main>
        <!-- Home Page -->
        <div id="home" class="page active">
            <section class="hero">
                <h1>Welcome to Book Haven</h1>
                <p>Your premier destination for books, magazines, and literary treasures. Discover worlds between the pages and join our community of book lovers.</p>
            </section>

            <section class="promo-section">
                <h2 style="text-align: center; color: var(--primary-color); margin-bottom: 2rem; font-family: Arial, sans-serif;">Featured Offers</h2>
                <div class="cards">
                    <div class="card">
                        <div class="card-icon">📚</div>
                        <h3>New Releases</h3>
                        <p>Get 20% off all new releases this month. Discover the latest bestsellers and critically acclaimed novels.</p>
                    </div>
                    <div class="card">
                        <div class="card-icon">🎯</div>
                        <h3>Staff Picks</h3>
                        <p>Our expert recommendations - books our team can't stop talking about. Curated for every reading taste.</p>
                    </div>
                    <div class="card">
                        <div class="card-icon">📖</div>
                        <h3>Reading Club</h3>
                        <p>Join our monthly book club meetings. Connect with fellow readers and explore new genres together.</p>
                    </div>
                </div>
            </section>

            <section class="categories-section">
                <h2 style="text-align: center; color: var(--primary-color); margin-bottom: 2rem; font-family: Arial, sans-serif;">Shop by Category</h2>
                <div class="cards">
                    <div class="card">
                        <div class="card-icon">🏰</div>
                        <h3>Fiction</h3>
                        <p>Immerse yourself in captivating stories</p>
                    </div>
                    <div class="card">
                        <div class="card-icon">🔬</div>
                        <h3>Non-Fiction</h3>
                        <p>Learn something new every day</p>
                    </div>
                    <div class="card">
                        <div class="card-icon">📰</div>
                        <h3>Magazines</h3>
                        <p>Stay current with the latest trends</p>
                    </div>
                    <div class="card">
                        <div class="card-icon">🎁</div>
                        <h3>Gifts & Accessories</h3>
                        <p>Perfect presents for book lovers</p>
                    </div>
                </div>
            </section>
        </div>

        <!-- Gallery Page -->
        <div id="gallery" class="page">
            <h1 style="text-align: center; color: var(--primary-color); margin-bottom: 2rem; font-family: Arial, sans-serif;">Our Collection</h1>
            
            <div class="filters">
                <button class="filter-btn active" onclick="filterProducts('all')">All Products</button>
                <button class="filter-btn" onclick="filterProducts('fiction')">Fiction</button>
                <button class="filter-btn" onclick="filterProducts('non-fiction')">Non-Fiction</button>
                <button class="filter-btn" onclick="filterProducts('magazines')">Magazines</button>
                <button class="filter-btn" onclick="filterProducts('accessories')">Accessories</button>
            </div>

            <div style="text-align: center; margin-bottom: 2rem;">
                <button class="btn" onclick="openCart()">🛒 View Cart (<span id="cart-count">0</span>)</button>
            </div>

            <div class="products" id="products-container">
                <!-- Products will be dynamically generated -->
            </div>
        </div>

        <!-- About Page -->
        <div id="about" class="page">
            <h1 style="text-align: center; color: var(--primary-color); margin-bottom: 2rem; font-family: Arial, sans-serif;">About Book Haven</h1>
            
            <div class="cards">
                <div class="card">
                    <h3>Our Story</h3>
                    <p>Founded in 1995, Book Haven has been serving the literary needs of our community for over 30 years. We believe in the power of books to transform lives and build connections.</p>
                </div>
                <div class="card">
                    <h3>Our Mission</h3>
                    <p>To provide our community with access to quality literature, create a welcoming space for readers, and support local authors and literary events.</p>
                </div>
            </div>

            <div class="form-container">
                <h2 style="color: var(--primary-color); margin-bottom: 1rem; font-family: Arial, sans-serif;">Business Hours & Information</h2>
                <table class="info-table">
                    <thead>
                        <tr>
                            <th>Days</th>
                            <th>Hours</th>
                            <th>Services</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Monday - Friday</td>
                            <td>9:00 AM - 8:00 PM</td>
                            <td>Full Service</td>
                        </tr>
                        <tr>
                            <td>Saturday</td>
                            <td>9:00 AM - 6:00 PM</td>
                            <td>Full Service</td>
                        </tr>
                        <tr>
                            <td>Sunday</td>
                            <td>11:00 AM - 5:00 PM</td>
                            <td>Limited Service</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="form-container">
                <h2 style="color: var(--primary-color); margin-bottom: 1rem; font-family: Arial, sans-serif;">Contact Us / Customer Feedback</h2>
                <form id="contact-form" onsubmit="handleContactForm(event)">
                    <div class="form-group">
                        <label for="name">Name *</label>
                        <input type="text" id="name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email *</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="phone">Phone Number</label>
                        <input type="tel" id="phone" name="phone">
                    </div>
                    <div class="form-group">
                        <label for="message">Message / Custom Order Information *</label>
                        <textarea id="message" name="message" required placeholder="Tell us about your feedback or custom order requirements..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="custom-order" name="customOrder"> This is a custom order request
                        </label>
                    </div>
                    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                        <button type="submit" class="btn">Submit</button>
                        <button type="button" class="btn btn-secondary" onclick="clearContactForm()">Clear Form</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Community Page -->
        <div id="community" class="page">
            <h1 style="text-align: center; color: var(--primary-color); margin-bottom: 2rem; font-family: Arial, sans-serif;">Community Corner</h1>
            
            <section style="margin-bottom: 3rem;">
                <h2 style="color: var(--primary-color); margin-bottom: 2rem; font-family: Arial, sans-serif;">Customer Spotlight</h2>
                <div class="cards">
                    <div class="card">
                        <h3>Sarah M.</h3>
                        <p>"Book Haven is my sanctuary! The staff always has perfect recommendations, and the cozy atmosphere makes it impossible to leave empty-handed. It's more than a bookstore—it's a community."</p>
                    </div>
                    <div class="card">
                        <h3>James T.</h3>
                        <p>"I've been coming here for years. The local author section is fantastic, and their book club has introduced me to so many great reads I never would have discovered on my own."</p>
                    </div>
                    <div class="card">
                        <h3>Maria L.</h3>
                        <p>"As a teacher, I appreciate their educational book selection and how they support literacy programs. They even gave us a discount for our classroom library!"</p>
                    </div>
                </div>
            </section>

            <section style="margin-bottom: 3rem;">
                <h2 style="color: var(--primary-color); margin-bottom: 2rem; font-family: Arial, sans-serif;">Community Involvement</h2>
                <div class="cards">
                    <div class="card">
                        <div class="card-icon">📚</div>
                        <h3>Local Library Partnership</h3>
                        <p>We proudly support our local library's summer reading program, providing books and prizes for young readers in our community.</p>
                    </div>
                    <div class="card">
                        <div class="card-icon">🎓</div>
                        <h3>School Outreach</h3>
                        <p>Our education program brings authors to local schools and offers discounts to teachers building their classroom libraries.</p>
                    </div>
                    <div class="card">
                        <div class="card-icon">🤝</div>
                        <h3>Charity Book Drive</h3>
                        <p>Annual book collection for underprivileged communities, spreading literacy and the joy of reading throughout our region.</p>
                    </div>
                </div>
            </section>

            <section>
                <h2 style="color: var(--primary-color); margin-bottom: 2rem; font-family: Arial, sans-serif;">Upcoming Events</h2>
                <div class="form-container">
                    <ul style="list-style: none; padding: 0;">
                        <li style="padding: 1rem; border-bottom: 1px solid #eee;">
                            <strong style="color: var(--primary-color);">Author Reading Series</strong><br>
                            <em>Every first Friday of the month, 7:00 PM</em><br>
                            Join us for intimate readings by local and visiting authors.
                        </li>
                        <li style="padding: 1rem; border-bottom: 1px solid #eee;">
                            <strong style="color: var(--primary-color);">Book Club Meeting</strong><br>
                            <em>Third Saturday of each month, 2:00 PM</em><br>
                            This month we're discussing contemporary fiction favorites.
                        </li>
                        <li style="padding: 1rem;">
                            <strong style="color: var(--primary-color);">Children's Story Time</strong><br>
                            <em>Every Wednesday, 10:30 AM</em><br>
                            Bring the little ones for interactive stories and activities.
                        </li>
                    </ul>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-subscribe">
                <h3>Subscribe to Our Newsletter</h3>
                <div class="subscribe-form">
                    <input type="email" id="newsletter-email" placeholder="Enter your email" required>
                    <button class="btn" onclick="handleSubscribe()">Subscribe</button>
                </div>
            </div>
            <nav class="footer-nav">
                <a href="#home" onclick="showPage('home')">Home</a>
                <a href="#gallery" onclick="showPage('gallery')">Gallery</a>
                <a href="#about" onclick="showPage('about')">About Us</a>
                <a href="#community" onclick="showPage('community')">Community</a>
            </nav>
            <p>&copy; 2025 Book Haven Bookstore. Celebrating the written word since always.</p>
        </div>
    </footer>

    <div id="cart-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeCart()">&times;</span>
            <h2 style="color: var(--primary-color); margin-bottom: 1rem; font-family: Arial, sans-serif;">Shopping Cart</h2>
            <div id="cart-items"></div>
            <div id="cart-actions" style="margin-top: 2rem; text-align: center; display: none;">
                <button class="btn" onclick="processOrder()" style="margin-right: 1rem;">Process Order</button>
                <button class="btn btn-secondary" onclick="clearCart()">Clear Cart</button>
            </div>
        </div>
    </div>

    <script>
        let currentPage = 'home';
        let cart = [];
        let currentFilter = 'all';
        
        const products = [
            { id: 1, title: "Sorcerer's Shadowed Chronicles", category: "fiction", price: "$29.99", description: "Epic fantasy adventure", image: "images/Client3_Book3.png" },
            { id: 2, title: "Glory Riders", category: "fiction", price: "$24.99", description: "Biker adventure tales", image: "images/Client3_Book2.png" },
            { id: 3, title: "Travel Magazine", category: "magazines", price: "$8.99", description: "Dream destinations worldwide", image: "images/Client3_Magazine2.png" },
            { id: 4, title: "EAT Magazine", category: "magazines", price: "$9.99", description: "Culinary adventures", image: "images/Client3_Magazine3.png" },
            { id: 5, title: "Brie Mine 4Ever", category: "magazines", price: "$12.99", description: "For cheese lovers", image: "images/Client3_Book1.png" },
            { id: 6, title: "Book Haven Notebook", category: "accessories", price: "$15.99", description: "Premium lined journal", image: "images/Client3_Notebook.png" },
            { id: 7, title: "READ Tote Bag", category: "accessories", price: "$18.99", description: "Canvas book bag", image: "images/Client3_Totebag.png" },
            { id: 8, title: "Book Haven Stickers", category: "accessories", price: "$6.99", description: "Set of 12 designs", image: "images/Client3_Stickers.png" },
            { id: 9, title: "The Science of Everything", category: "non-fiction", price: "$32.99", description: "Comprehensive scientific analysis", image: "images/Client3_Magazine1.png" }
        ];

        document.addEventListener('DOMContentLoaded', function() {
            loadProducts();
            updateCartCount();
            
            loadFromLocalStorage();
        });

        function showPage(pageId) {
            // Hide all pages
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => page.classList.remove('active'));
            
            // Show selected page
            document.getElementById(pageId).classList.add('active');
            
            // Update navigation
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => link.classList.remove('active'));
            
            const activeLink = document.querySelector(`[onclick="showPage('${pageId}')"]`);
            if (activeLink) {
                activeLink.classList.add('active');
            }
            
            currentPage = pageId;
            
            sessionStorage.setItem('currentPage', pageId);
        }

        function loadProducts() {
            const container = document.getElementById('products-container');
            container.innerHTML = '';
            
            const filteredProducts = currentFilter === 'all' 
                ? products 
                : products.filter(product => product.category === currentFilter);
            
            filteredProducts.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.setAttribute('data-category', product.category);
                
                productCard.innerHTML = `
                    <div class="product-image" style="background-image: url('${product.image}'); background-size: cover; background-position: center; position: relative;">
                        <div style="position: absolute; top: 10px; right: 10px; background: var(--primary-color); color: white; padding: 0.25rem 0.5rem; border-radius: 12px; font-size: 0.8rem; font-weight: bold;">
                            ${getProductIcon(product.category)}
                        </div>
                    </div>
                    <div class="product-info">
                        <div class="product-title">${product.title}</div>
                        <p>${product.description}</p>
                        <div class="product-price">${product.price}</div>
                        <button class="btn" onclick="addToCart(${product.id})" style="margin-top: 1rem; width: 100%;">
                            Add to Cart
                        </button>
                    </div>
                `;
                
                container.appendChild(productCard);
            });
        }

        function getProductIcon(category) {
            const icons = {
                'fiction': '📚',
                'non-fiction': '🔬',
                'magazines': '📰',
                'accessories': '🎁'
            };
            return icons[category] || '📖';
        }

        function filterProducts(category) {
            currentFilter = category;
            
            const filterBtns = document.querySelectorAll('.filter-btn');
            filterBtns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            loadProducts();
        }

        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            if (product) {
                const existingItem = cart.find(item => item.id === productId);
                if (existingItem) {
                    existingItem.quantity++;
                } else {
                    cart.push({ ...product, quantity: 1 });
                }
                
                updateCartCount();
                saveToLocalStorage();
                
                showSuccessMessage(`${product.title} added to cart!`);
            }
        }

        function updateCartCount() {
            const count = cart.reduce((total, item) => total + item.quantity, 0);
            document.getElementById('cart-count').textContent = count;
        }

        function openCart() {
            const modal = document.getElementById('cart-modal');
            const cartItems = document.getElementById('cart-items');
            const cartActions = document.getElementById('cart-actions');
            
            if (cart.length === 0) {
                cartItems.innerHTML = '<div class="cart-empty">Your cart is empty</div>';
                cartActions.style.display = 'none';
            } else {
                let cartHTML = '';
                let total = 0;
                
                cart.forEach(item => {
                    const itemTotal = parseFloat(item.price.replace('$', '')) * item.quantity;
                    total += itemTotal;
                    
                    cartHTML += `
                        <div class="cart-item">
                            <div>
                                <strong>${item.title}</strong><br>
                                <small>Quantity: ${item.quantity} × ${item.price}</small>
                            </div>
                            <div>$${itemTotal.toFixed(2)}</div>
                        </div>
                    `;
                });
                
                cartHTML += `
                    <div class="cart-item" style="border-top: 2px solid var(--primary-color); font-weight: bold;">
                        <div>Total</div>
                        <div>$${total.toFixed(2)}</div>
                    </div>
                `;
                
                cartItems.innerHTML = cartHTML;
                cartActions.style.display = 'block';
            }
            
            modal.style.display = 'block';
        }

        function closeCart() {
            document.getElementById('cart-modal').style.display = 'none';
        }

        function processOrder() {
            if (cart.length > 0) {
                alert('Thank you for your order!');
                cart = [];
                updateCartCount();
                saveToLocalStorage();
                closeCart();
            }
        }

        function clearCart() {
            cart = [];
            updateCartCount();
            saveToLocalStorage();
            alert('Cart is cleared!');
            closeCart();
        }

        function handleContactForm(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const data = {
                name: formData.get('name'),
                email: formData.get('email'),
                phone: formData.get('phone'),
                message: formData.get('message'),
                customOrder: formData.get('customOrder') ? true : false,
                timestamp: new Date().toISOString()
            };
            
            const submissions = JSON.parse(localStorage.getItem('contactSubmissions') || '[]');
            submissions.push(data);
            localStorage.setItem('contactSubmissions', JSON.stringify(submissions));
            
            alert(`Thank you for your message, ${data.name}!`);
            event.target.reset();
        }

        function clearContactForm() {
            document.getElementById('contact-form').reset();
        }

        function handleSubscribe() {
            const email = document.getElementById('newsletter-email').value;
            if (email) {
                const subscribers = JSON.parse(localStorage.getItem('newsletterSubscribers') || '[]');
                if (!subscribers.includes(email)) {
                    subscribers.push(email);
                    localStorage.setItem('newsletterSubscribers', JSON.stringify(subscribers));
                }
                
                alert('Thank you for subscribing!');
                document.getElementById('newsletter-email').value = '';
            }
        }

        function showSuccessMessage(message) {
            const successDiv = document.createElement('div');
            successDiv.className = 'success-message';
            successDiv.textContent = message;
            
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                successDiv.remove();
            }, 3000);
        }

        function saveToLocalStorage() {
            localStorage.setItem('bookHavenCart', JSON.stringify(cart));
        }

        function loadFromLocalStorage() {
            const savedCart = localStorage.getItem('bookHavenCart');
            if (savedCart) {
                cart = JSON.parse(savedCart);
                updateCartCount();
            }
            
            const savedPage = sessionStorage.getItem('currentPage');
            if (savedPage && savedPage !== currentPage) {
                showPage(savedPage);
            }
        }

        window.onclick = function(event) {
            const modal = document.getElementById('cart-modal');
            if (event.target === modal) {
                closeCart();
            }
        }

        window.addEventListener('popstate', function(event) {
            const hash = window.location.hash.substring(1);
            if (hash) {
                showPage(hash);
            }
        });

        function updateURL(pageId) {
            history.pushState({ page: pageId }, '', `#${pageId}`);
        }
    </script>
</body>
</html>